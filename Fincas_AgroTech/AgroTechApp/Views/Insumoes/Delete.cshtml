@model AgroTechApp.Models.DB.Insumo

@{
    ViewData["Title"] = "Eliminar Insumo";
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eliminar Insumo - AgroTech</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #2E8B57;
            --primary-dark: #26734d;
            --primary-light: #3CB371;
            --secondary: #F4A460;
            --danger: #dc3545;
            --danger-dark: #c82333;
            --warning: #ffc107;
            --info: #17a2b8;
            --light: #f8f9fa;
            --dark: #333;
            --gray: #6c757d;
            --border: #e1e5e9;
            --shadow: rgba(0, 0, 0, 0.1);
            --success: #28a745;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: var(--dark);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .delete-container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            overflow: hidden;
        }

        /* HEADER */
        .modal-header {
            background: linear-gradient(135deg, var(--danger), #e74c3c);
            color: white;
            padding: 2.5rem;
            text-align: center;
            position: relative;
        }

        .warning-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            display: block;
        }

        /* BODY */
        .modal-body {
            padding: 2rem;
        }

        .insumo-card {
            display: flex;
            gap: 1.5rem;
            background: linear-gradient(135deg, #fff5f5, #ffe6e6);
            border-radius: 15px;
            padding: 2rem;
            border-left: 6px solid var(--danger);
        }

        .insumo-icon {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: var(--danger);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .detail-card {
            background: var(--light);
            padding: 1.2rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        /* WARNING BOX */
        .warning-section {
            margin-top: 2rem;
            background: #fff3cd;
            padding: 1.2rem;
            border-radius: 10px;
            border: 2px solid #ffeaa7;
            display: flex;
            gap: 1rem;
        }

        /* BUTTONS */
        .btn-group {
            margin-top: 2rem;
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .btn {
            padding: 0.9rem 1.6rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            border: none;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-secondary {
            background: var(--gray);
        }
    </style>
</head>
<body>

    <div class="delete-container">

        <!-- HEADER -->
        <div class="modal-header">
            <div class="warning-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h1>Eliminar Insumo</h1>
            <p>Esta acción no se puede deshacer. Proceda con precaución.</p>
        </div>

        <!-- BODY -->
        <div class="modal-body">

            <!-- INSUMO MAIN CARD -->
            <div class="insumo-card">
                <div class="insumo-icon">
                    <i class="fas fa-seedling"></i>
                </div>

                <div class="insumo-info">
                    <h2 class="insumo-name">@Model.Nombre</h2>
                    <span class="insumo-id">ID: @Model.InsumoId</span>
                    <p class="insumo-description">
                        Categoría: <strong>@Model.Categoria?.Nombre</strong><br />
                        Unidad: <strong>@Model.Unidad?.Nombre</strong>
                    </p>
                </div>
            </div>

            <!-- DETAILS GRID -->
            <div class="details-grid">
                <div class="detail-card">
                    <strong>Stock Actual:</strong><br />
                    @ViewBag.StockActual unidades
                </div>

                <div class="detail-card">
                    <strong>Categoría:</strong><br />
                    @Model.Categoria?.Nombre
                </div>

                <div class="detail-card">
                    <strong>Unidad:</strong><br />
                    @Model.Unidad?.Nombre
                </div>

                <div class="detail-card">
                    <strong>Finca:</strong><br />
                    @Model.Finca?.Nombre
                </div>
            </div>

            <!-- WARNING -->
            <div class="warning-section">
                <i class="fas fa-radiation-alt"></i>
                <div>
                    <h3>Advertencia Crítica</h3>
                    <p>Se eliminará el insumo y todos sus movimientos asociados. Esta acción es irreversible.</p>
                </div>
            </div>

            <!-- BUTTONS -->
            <div class="btn-group">

                <!-- EDITAR (opcional) -->
                <a asp-action="Edit" asp-route-id="@Model.InsumoId"
                   class="btn btn-secondary">
                    <i class="fas fa-edit"></i> Editar
                </a>

                <!-- CANCELAR -->
                <a asp-action="Index" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Cancelar
                </a>

                <!-- ELIMINAR -->
                <button type="button" class="btn btn-danger" id="deleteBtn">
                    <i class="fas fa-trash"></i> Eliminar Permanentemente
                </button>
            </div>

            <!-- FORM REAL PARA DELETE -->
            <form id="deleteForm" asp-action="Delete" method="post" style="display:none;">
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="InsumoId" />
            </form>

        </div>
    </div>

    <!-- SCRIPT -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const deleteBtn = document.getElementById('deleteBtn');

            deleteBtn.addEventListener('click', function () {

                const nombre = "@Model.Nombre";
                const stock = "@ViewBag.StockActual";
                const id = "@Model.InsumoId";

                const confirmed = confirm(
                    `¿CONFIRMAR ELIMINACIÓN?\n\n` +
                    `INSUMO: ${nombre}\n` +
                    `ID: ${id}\n` +
                    `STOCK ACTUAL: ${stock}\n\n` +
                    `Esta acción es PERMANENTE.\n\n¿Desea continuar?`
                );

                if (confirmed) {
                    document.getElementById("deleteForm").submit();
                }
            });
        });
    </script>

</body>
</html>
